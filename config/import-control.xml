<?xml version="1.0"?>
<!DOCTYPE import-control PUBLIC
    "-//Checkstyle//DTD ImportControl Configuration 1.4//EN"
    "https://checkstyle.org/dtds/import_control_1_4.dtd">

<import-control pkg="org.sonar.plugins.checkstyle">

  <allow pkg="java.io"/>
  <allow pkg="java.nio"/>
  <allow pkg="java.util"/>
  <allow pkg="java.net"/>
  <allow pkg="javax.xml.stream"/>
  <allow class="javax.annotation.Nullable"/>
  <allow class="javax.annotation.ParametersAreNonnullByDefault"/>

  <allow class="com.puppycrawl.tools.checkstyle.api.AuditEvent"/>
  <allow class="com.puppycrawl.tools.checkstyle.api.AuditListener"/>
  <allow class="com.puppycrawl.tools.checkstyle.api.AutomaticBean"/>
  <allow class="com.puppycrawl.tools.checkstyle.api.CheckstyleException"/>
  <allow class="com.puppycrawl.tools.checkstyle.api.Configuration"/>
  <allow class="com.puppycrawl.tools.checkstyle.api.SeverityLevel"/>
  <allow class="com.puppycrawl.tools.checkstyle.ConfigurationLoader"/>
  <allow class="com.puppycrawl.tools.checkstyle.Checker"/>
  <allow class="com.puppycrawl.tools.checkstyle.DefaultConfiguration"/>
  <allow class="com.puppycrawl.tools.checkstyle.PackageNamesLoader"/>
  <allow class="com.puppycrawl.tools.checkstyle.PropertiesExpander"/>
  <allow class="com.puppycrawl.tools.checkstyle.XMLLogger"/>

  <allow pkg="org.apache.commons.io"/>
  <allow pkg="org.apache.commons.lang"/>
  <allow class="com.google.common.annotations.VisibleForTesting"/>

  <allow class="org.codehaus.staxmate.SMInputFactory"/>
  <allow class="org.codehaus.staxmate.in.SMInputCursor"/>

  <allow pkg="org.slf4j"/>
  <allow pkg="org.sonar.api"/>
  <allow pkg="org.sonar.api.batch"/>
  <allow pkg="org.sonar.api.batch.fs"/>
  <allow pkg="org.sonar.api.batch.rule"/>
  <allow pkg="org.sonar.api.rule"/>

  <allow pkg="org.sonar.plugins.checkstyle.rule" local-only="true"/>
  <allow pkg="org.sonar.plugins.checkstyle.metadata" local-only="true"/>

  <subpackage name="metadata">
    <allow pkg="com.fasterxml.jackson.databind"/>
    <allow pkg="com.fasterxml.jackson.dataformat.yaml"/>

    <allow class="com.google.common.collect.ImmutableList"/>
    <allow class="com.google.common.collect.ImmutableMap"/>

    <allow class="com.puppycrawl.tools.checkstyle.PackageObjectFactory"/>
    <allow class="com.puppycrawl.tools.checkstyle.api.AbstractCheck"/>
    <allow class="com.puppycrawl.tools.checkstyle.checks.javadoc.AbstractJavadocCheck"/>
    <allow class="com.puppycrawl.tools.checkstyle.utils.JavadocUtil"/>
    <allow class="com.puppycrawl.tools.checkstyle.utils.TokenUtil"/>
    <allow class="com.puppycrawl.tools.checkstyle.meta.ModuleDetails"/>
    <allow class="com.puppycrawl.tools.checkstyle.meta.ModulePropertyDetails"/>
    <allow class="com.puppycrawl.tools.checkstyle.meta.ModuleType"/>
    <allow class="com.puppycrawl.tools.checkstyle.meta.XmlMetaReader"/>

    <allow pkg="org.sonar.plugins.checkstyle.metadata" local-only="true"/>
  </subpackage>

  <subpackage name="rule">
   <allow class="org.sonar.plugins.checkstyle.CheckstyleSeverityUtils"/>
  </subpackage>

</import-control>
